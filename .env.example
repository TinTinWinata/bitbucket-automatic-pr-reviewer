# PR Automation Service Configuration

# Server Configuration
PORT=3000

# Claude Model Configuration
CLAUDE_MODEL=sonnet
CLAUDE_TIMEOUT_CONFIG=10
# Maximum diff size in KB to include directly in prompt (default: 200KB)
# If diff exceeds this, merge-base instructions will be added instead
# Calculation: ~200KB = ~50,000 tokens (25% of 200K context window)
# Adjust based on your needs: 50KB (conservative), 200KB (default), 400KB (aggressive)
MAX_DIFF_SIZE_KB=200

# Bitbucket Configuration
BITBUCKET_TOKEN=your-bitbucket-app-password
BITBUCKET_USER=your-bitbucket-user

# Alternative: Use username + password instead of token
# BITBUCKET_USER=your-username
# BITBUCKET_PASSWORD=your-password

# Non allowed user based on atlassian name
# NON_ALLOWED_USERS= test

# Webhook Security
BITBUCKET_WEBHOOK_SECRET=your-webhook-secret-from-bitbucket
ALLOWED_WORKSPACE=xriopteam

# Event Filtering
# Set to 'true' to only process PR creation events (ignore updates)
# Set to 'false' to process all PR events (created + updated)
PROCESS_ONLY_CREATED=false

# Logging Configuration
# Log level: error, warn, info, debug (default: environment-based)
LOG_LEVEL=info

# Log file retention in days (default: 30)
LOG_FILE_RETENTION_DAYS=30

# Maximum log file size before rotation (default: 20m)
LOG_MAX_FILE_SIZE=20m

# Enable console logging (default: true)
LOG_ENABLE_CONSOLE=true

# Enable file logging (default: true)
LOG_ENABLE_FILE=true

# Circuit breaker configuration
CB_FAILURE_THRESHOLD=3
CB_RESET_TIMEOUT_MS=30000

# Metrics Persistence
METRICS_PERSISTENCE_ENABLED=false
METRICS_PERSISTENCE_TYPE=sqlite
